
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Dunders &#8212; Bibliothèques Python 0.1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="enum" href="../enum/index.html" />
    <link rel="prev" title="datetime" href="../datetime/index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dunders">
<span id="dunders-tutorial"></span><h1>Dunders<a class="headerlink" href="#dunders" title="Permalink to this headline">¶</a></h1>
<p>Par Marc Friedli <a class="footnote-reference" href="#mf" id="id1">[1]</a></p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Le mot dunder est un raccourci de <em>Double UNDERscore</em> et représente toutes les méthodes Python qui commencent et finissent par un double underscore (par ex. <code class="docutils literal"><span class="pre">__init__()</span></code>).</p>
<p>Les dunders sont des méthodes très puissantes et régulièrement utilisées en python. Ce sont des méthodes universelles que toute classe possède (un peu à l’image de la class Object dans Java).</p>
<p>Cependant, dans python, les dunders sont rarement appelés directement.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">À faire</p>
<p class="last">Un peu imprécis car il n’y a pas que des méthodes. <code class="docutils literal"><span class="pre">__name__</span></code> ou <code class="docutils literal"><span class="pre">__file__</span></code></p>
</div>
<p>Par exemple :</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">toto</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MyClass</span><span class="p">()</span>
</pre></div>
</div>
<p>fera appel aux méthodes <code class="docutils literal"><span class="pre">__new__()</span></code> et <code class="docutils literal"><span class="pre">__init__()</span></code> même si ces méthodes n’ont pas été surchargées.</p>
<p>Les dunders ont des méthodes raccourci qui vont directement les appeler (autre raison pour laquelle on utilise régulièrement les dunders sans s’en rendre compte) :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span>
<span class="go">9</span>
</pre></div>
</div>
<p>fera appel au dunder <code class="docutils literal"><span class="pre">__add__()</span></code></p>
<p>Ou bien :</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;I&#39;m a text&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>fera appel au dunder <code class="docutils literal"><span class="pre">__str__()</span></code> de <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>.</p>
<p>La grande puissance des dunders est leur universalité. En effet, Python a été programmé de manière à ce qu’une opération soit toujours relié au même <em>dunder</em>.</p>
<p>Par exemple, dans beaucoup de langages, si on veut connaitre la taille d’un truc, il faut d’abord savoir de quoi on parle (un tableau, une liste, un string etc.) avant de faire appel à la méthode appropriée. Dans python, on utilise toujours le dunder __len__() :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Travis est très très compliqué.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">SomeClass</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class d&#39;exemple.&quot;&quot;&quot;</span>

    <span class="n">grammar</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Some string&quot;</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Another string&quot;</span><span class="p">,</span>
        <span class="mi">3</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
        <span class="mi">4</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialisateur.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>


<span class="n">sc</span> <span class="o">=</span> <span class="n">SomeClass</span><span class="p">(</span><span class="s2">&quot;Totoro&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>  <span class="c1"># affiche la taille du string (6)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">grammar</span><span class="p">))</span>  <span class="c1"># affiche le nombre d&#39;éléments (4)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">À faire</p>
<p class="last">Cet exemple n’est pas représentatif de l’usage de <code class="docutils literal"><span class="pre">len</span></code>.</p>
</div>
<p>Voir: <a class="reference external" href="http://lucumr.pocoo.org/2011/7/9/python-and-pola/">Python and the Principle of Least Astonishment</a></p>
<p>Une autre grande utilisation des dunders consiste à les surcharger de manière à les personalisé.</p>
<p>De plus, par convention, on déclare une méthode privée comme étant un dunder :</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">__myPrivateMethod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">none</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">À faire</p>
<p>Ceci est faux! On n’invente pas de <em>dunders</em> personnels, jamais.</p>
<p class="last"><span class="target" id="index-2"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0008"><strong>PEP 8</strong></a></p>
</div>
</div>
<div class="section" id="exemples">
<h2>Exemples<a class="headerlink" href="#exemples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Travis est trop compliqué.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Main</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class simulant une main aux cartes.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialisateur.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cartes</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">ajouter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">carte</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Méthode pour add une carte.&quot;&quot;&quot;</span>
        <span class="n">obj2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartes</span><span class="p">)</span>  <span class="c1"># Converti en liste</span>
        <span class="n">obj2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">carte</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cartes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">obj2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Redéfinition de str.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartes</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Redéfinition de len.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Est appelé quand on fait objet[index] ou objet[key].&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Est appelé quand on fait un iter(objet).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Est appelé quand on fait reversed(objt).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Est appelé quand &quot;in objet&quot;.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartes</span>


<span class="n">main</span> <span class="o">=</span> <span class="n">Main</span><span class="p">(</span><span class="s1">&#39;1Coeur&#39;</span><span class="p">,</span> <span class="s1">&#39;7Pique&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">main</span><span class="p">))</span>

<span class="n">main</span><span class="o">.</span><span class="n">ajouter</span><span class="p">(</span><span class="s1">&#39;AsCoeur&#39;</span><span class="p">)</span>

<span class="c1"># parc qu&#39;on a défini __iter__!</span>
<span class="k">for</span> <span class="n">carte</span> <span class="ow">in</span> <span class="n">main</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">carte</span><span class="p">)</span>

<span class="c1"># 1Coeur</span>
<span class="nb">print</span><span class="p">(</span><span class="n">main</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># False</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3Coeur&#39;</span> <span class="ow">in</span> <span class="n">main</span><span class="p">)</span>

<span class="c1"># 3</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">main</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="difference-entre-str-et-repr">
<h3>Différence entre <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> et <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#repr" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">repr()</span></code></a><a class="headerlink" href="#difference-entre-str-et-repr" title="Permalink to this headline">¶</a></h3>
<p>Les deux servent à afficher l’objets mais pas de la même manière :</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">str:</th><td class="field-body">se veut d’être lisible, il donne les informations qu’un utilisateur veut savoir et non le programme. Elle est ambigu et permet donc facilement le cast.</td>
</tr>
<tr class="field-even field"><th class="field-name">repr:</th><td class="field-body">se veut au contraire non ambigu. Il doit représenter l’objet tel qu’il est réellement.</td>
</tr>
</tbody>
</table>
<p>De base, quand on chercher à afficher un objet, à moins que la méthode <code class="docutils literal"><span class="pre">__str__()</span></code> soit redéfinie, c’est la méthode repr qui sera appelée.</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;3&quot;</span><span class="p">))</span> <span class="c1"># return True car str est ambigu</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="nb">repr</span><span class="p">(</span><span class="s2">&quot;3&quot;</span><span class="p">))</span> <span class="c1"># return False car non-ambigu (Int != String)</span>
</pre></div>
</div>
<p>Idéalement, il faudrait toujours redéfinir la méthode <code class="docutils literal"><span class="pre">__repr__()</span></code> et redéfinir <code class="docutils literal"><span class="pre">__str__()</span></code> uniquement si on a besoin de l’ambiguïté.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Il existe beaucoup de dunders. Il faut puiser dans la doc afin de connaitre ceux dont on a l’usage et savoir quand ils sont utilisés.
Ce sont de puissants outils de Python qui permettent de facilement spécialiser le comportement d’un objet.</p>
</div>
<div class="section" id="bibliographie">
<h2>Bibliographie<a class="headerlink" href="#bibliographie" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The Python Data model, extrait de Fluent Python</li>
<li><a class="reference external" href="http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-6/">http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-6/</a></li>
<li><a class="reference external" href="http://www.diveintopython3.net/special-method-names.html">http://www.diveintopython3.net/special-method-names.html</a></li>
</ul>
<table class="docutils footnote" frame="void" id="mf" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>&lt;<a class="reference external" href="mailto:marc&#46;friedli&#37;&#52;&#48;he-arc&#46;ch">marc<span>&#46;</span>friedli<span>&#64;</span>he-arc<span>&#46;</span>ch</a>&gt;</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table des Matières</a></h3>
  <ul>
<li><a class="reference internal" href="#">Dunders</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#exemples">Exemples</a><ul>
<li><a class="reference internal" href="#difference-entre-str-et-repr">Différence entre <code class="docutils literal"><span class="pre">str</span></code> et <code class="docutils literal"><span class="pre">repr()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#bibliographie">Bibliographie</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../datetime/index.html" title="Chapitre précédent"><code class="docutils literal"><span class="pre">datetime</span></code></a></li>
      <li>Next: <a href="../enum/index.html" title="Chapitre suivant"><code class="docutils literal"><span class="pre">enum</span></code></a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/dunders/index.rst.txt"
            rel="nofollow">Montrer le code source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016-2017, HE-Arc.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/dunders/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>